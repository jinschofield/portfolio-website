This is code heavily inspired by Greg Berge for my personal website.
